# faiss_manager.py
def create_retriever(self, search_kwargs: dict = None) -> BaseRetriever:
    """仅创建检索器（不包含LLM）"""
    if not self.vectorstore:
        raise ValueError("请先调用create_from_texts()")
    
    return self.vectorstore.as_retriever(
        search_kwargs=search_kwargs or {"k": 3}
    )

# document_processor.py
def __create_qa_chain(self) -> RetrievalQA:
    """创建完整的QA链"""
    return RetrievalQA.from_chain_type(
        llm=self.llm,  # 使用初始化好的LLM
        chain_type="stuff",
        retriever=self.faiss_manager.create_retriever(
            search_kwargs={"k": 3, "score_threshold": 0.7}
        ),
        return_source_documents=True
    )